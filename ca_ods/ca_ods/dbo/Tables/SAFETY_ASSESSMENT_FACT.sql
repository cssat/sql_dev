CREATE TABLE [dbo].[SAFETY_ASSESSMENT_FACT] (
    [ID_SAFETY_ASSESSMENT_FACT]           INT           NOT NULL,
    [ID_SFTY_ASMNT_PART]                  INT           NULL,
    [ID_SFTY_ASMNT_PLAN]                  INT           NULL,
    [ID_INTAKE_FACT]                      INT           NULL,
    [ID_CALENDAR_DIM_APPROVAL]            INT           NULL,
    [ID_CALENDAR_DIM_INVESTIGATION_BEGIN] INT           NULL,
    [ID_CALENDAR_DIM_INVESTIGATION_END]   INT           NULL,
    [ID_CASE_DIM]                         INT           NULL,
    [ID_LOCATION_DIM]                     INT           NULL,
    [ID_PEOPLE_DIM_CHILD]                 INT           NULL,
    [ID_WORKER_DIM]                       INT           NULL,
    [CD_SDM_CALCULATED_RISK_LEVEL]        INT           NULL,
    [TX_SDM_CALCULATED_RISK_LEVEL]        VARCHAR (200) NULL,
    [CD_SDM_FINAL_RISK_LEVEL]             INT           NULL,
    [TX_SDM_FINAL_RISK_LEVEL]             VARCHAR (200) NULL,
    [CD_SDM_OVERRIDE_RISK_LEVEL]          INT           NULL,
    [TX_SDM_OVERRIDE_RISK_LEVEL]          VARCHAR (200) NULL,
    [CD_SDM_OVERRIDE_RISK_LEVEL_REASON]   INT           NULL,
    [TX_SDM_OVERRIDE_RISK_LEVEL_REASON]   VARCHAR (200) NULL,
    [FL_REQUIRED_SAFETY_ASSESSMENT]       TINYINT       NULL,
    [FL_RISK_LEVEL_OVERRIDE]              TINYINT       NULL,
    [FL_SAFETY_FACTOR1]                   TINYINT       NULL,
    [FL_SAFETY_FACTOR2]                   TINYINT       NULL,
    [FL_SAFETY_FACTOR3]                   TINYINT       NULL,
    [FL_SAFETY_FACTOR4]                   TINYINT       NULL,
    [FL_SAFETY_FACTOR5]                   TINYINT       NULL,
    [FL_SAFETY_FACTOR6]                   TINYINT       NULL,
    [FL_SAFETY_FACTOR7]                   TINYINT       NULL,
    [FL_SAFETY_FACTOR8]                   TINYINT       NULL,
    [FL_SAFETY_PLAN_EXISTS]               TINYINT       NULL,
    [QT_ABUSE_SCORE]                      INT           NULL,
    [QT_DAYS_UNTIL_START]                 INT           NULL,
    [QT_NEGLECT_SCORE]                    INT           NULL,
    [FL_EXPUNGED]                         CHAR (1)      NULL,
    [ID_CASE]                             INT           NULL,
    [ID_PRSN_CHILD]                       INT           NULL,
    CONSTRAINT [PK_ID_SAFETY_ASSESSMENT_FACT] PRIMARY KEY CLUSTERED ([ID_SAFETY_ASSESSMENT_FACT] ASC),
    CONSTRAINT [fk_SAFETY_ASSESSMENT_FACT_ID_CALENDAR_DIM_APPROVAL] FOREIGN KEY ([ID_CALENDAR_DIM_APPROVAL]) REFERENCES [dbo].[CALENDAR_DIM] ([ID_CALENDAR_DIM]),
    CONSTRAINT [fk_SAFETY_ASSESSMENT_FACT_ID_CALENDAR_DIM_INVESTIGATION_BEGIN] FOREIGN KEY ([ID_CALENDAR_DIM_INVESTIGATION_BEGIN]) REFERENCES [dbo].[CALENDAR_DIM] ([ID_CALENDAR_DIM]),
    CONSTRAINT [fk_SAFETY_ASSESSMENT_FACT_ID_CALENDAR_DIM_INVESTIGATION_END] FOREIGN KEY ([ID_CALENDAR_DIM_INVESTIGATION_END]) REFERENCES [dbo].[CALENDAR_DIM] ([ID_CALENDAR_DIM]),
    CONSTRAINT [fk_SAFETY_ASSESSMENT_FACT_ID_CASE_DIM] FOREIGN KEY ([ID_CASE_DIM]) REFERENCES [dbo].[CASE_DIM] ([ID_CASE_DIM]),
    CONSTRAINT [fk_SAFETY_ASSESSMENT_FACT_ID_INTAKE_FACT] FOREIGN KEY ([ID_INTAKE_FACT]) REFERENCES [dbo].[INTAKE_FACT] ([ID_INTAKE_FACT]),
    CONSTRAINT [fk_SAFETY_ASSESSMENT_FACT_ID_LOCATION_DIM] FOREIGN KEY ([ID_LOCATION_DIM]) REFERENCES [dbo].[LOCATION_DIM] ([ID_LOCATION_DIM]),
    CONSTRAINT [fk_SAFETY_ASSESSMENT_FACT_ID_PEOPLE_DIM_CHILD] FOREIGN KEY ([ID_PEOPLE_DIM_CHILD]) REFERENCES [dbo].[PEOPLE_DIM] ([ID_PEOPLE_DIM]),
    CONSTRAINT [fk_SAFETY_ASSESSMENT_FACT_ID_WORKER_DIM] FOREIGN KEY ([ID_WORKER_DIM]) REFERENCES [dbo].[WORKER_DIM] ([ID_WORKER_DIM])
);

